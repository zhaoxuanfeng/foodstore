<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="header :: header">
</head>
<body>

<div style="margin:10px 0;"></div>
<div id= "main_layout" class="easyui-layout" data-options="collapsedSize:'12'" style="width:100%;height:1040px;">
    <div data-options="region:'north',split:false" style="height:50px">
        <div>哭脸美食</div>
        <div  th:if="null != ${session.userInfo}">
            <span th:text="${session.userInfo.accountName}"></span>
            <a><span>退出</span></a>
        </div>
        <div th:if="null == ${session.userInfo}">
            <a href="/htm/userlogin.action"><span>请登录</span> </a>
        </div>
    </div>
    <div data-options="region:'south',split:false" style="height:50px;">主页底部

    </div>
    <div id="trolley_layout" data-options="region:'east',split:true,expandMode:'float'" title="购物车" style="width:180px;border: none"   >
        <form class="easyui-datagrid" id="tolley_from">
            <table>
                <thead>
                <tr>
                    <th field="foodName" width="80px"></th>
                    <th field="foodPrice" width="80px"></th>
                    <th field="count" width="80px"></th>
                </tr>
                </thead>
            </table>
        </form>
    </div>
    <div id="menu_layout" data-options="region:'west',split:false" title="菜单" style="width:100px;">
        <div class="easyui-accordion" data-options="fit:true,border:false">
            <div title="热门美食" style="padding:10px">
                <span class="menu-item"><a href="#" onclick="" th:value="1">热门小吃</a></span><br/>
                <span class="menu-item"><a href="#" onclick="" th:value="2">热门风味</a></span><br/>
                <span class="menu-item"><a href="#" onclick="" th:value="3">销量排行</a></span><br/>
            </div>
            <div title="八大菜系" style="padding:10px;">
                <span><a href="#" onclick="" th:value="1">鲁菜</a></span><br/>
                <span><a href="#" onclick="" th:value="2">川菜</a></span><br/>
                <span><a href="#" onclick="" th:value="3">浙菜</a></span><br/>
                <span><a href="#" onclick="" th:value="4">粤菜</a></span><br/>
                <span><a href="#" onclick="" th:value="5">苏菜</a></span><br/>
                <span><a href="#" onclick="" th:value="6">闽菜</a></span><br/>
                <span><a href="#" onclick="" th:value="7">湘菜</a></span><br/>
                <span><a href="#" onclick="" th:value="8">徽菜</a></span><br/>
            </div>
            <div title="美食分类" data-options="selected:true" style="padding:10px;">
                <span><a href="#" onclick="" th:value="1">饮品</a></span><br/>
                <span><a href="#" onclick="" th:value="2">主菜</a></span><br/>
                <span><a href="#" onclick="" th:value="3">主食</a></span><br/>
            </div>
        </div>
    </div>
    <div class="products" data-options="region:'center',title:'火爆销售',split:true" style="border: none">
        <ul id="hotStore">
        </ul>
    </div>
</div>
</body>
<footer th:replace="footer :: footer"></footer>
<script type="text/javascript" src="/js/jquery.cookie.js"></script>
<script th:inline="javascript" type="text/javascript">

</script>
<script type="text/javascript"  >
    <!-- 左边-->
    var bLeftExpand = false;
    $("#main_layout").panel({
        onCollapse:function(){
            if(!bLeftExpand){
                expandWest();
                bLeftExpand=true;
            }
        }
    });
    function expandWest(){
        var objs = $(".layout-expand-west");
        var obj = null;
        if(objs.length==1){
            obj = $(objs[0]);
            if(obj!=null && obj.length==1){
                $(obj).mouseover(function(){
                    $(obj).click(); //用于模拟点击收缩功能
                });
            }
        }
    }

    // $('#main_layout').layout('collapse','west');

    <!-- 右边-->
    var bRightExpand = false;

    $("#main_layout").panel({
        onCollapse:function(){
            if(!bRightExpand){
                expandEast();
                bRightExpand=true;
            }
        }
    });

    function expandEast(){
        var objs = $(".layout-expand-east");
        var obj = null;
        if(objs.length==1){
            obj = $(objs[0]);
            if(obj!=null && obj.length==1){
                $(obj).mouseover(function(){
                    $(obj).click();
                });
            }
        }
    }


    $(function() {
        $.ajax({
            url:"/view/searchInedxData.action",
            async:true,
            type:"GET",
            dataType:"json",
            success:function (data) {
                $.each(data.rows,function (index,hotRecipes) {
                    if(index%5 != 0){
                        childli =  '<li class="float_li"><a href="#" class="item" onclick="clickDetail('+
                            hotRecipes.id+')">' +
                            '<img src="'+hotRecipes.foodImgUrl+
                            '"/>'+
                            '<div><p>'+hotRecipes.foodName
                            +'</p><p>'+hotRecipes.foodIntroduce+
                            '</p></div></a></li>';
                        $("#hotStore").append(childli);
                    }else {
                        childli =  '<li><a href="#" class="item">' +
                            '<img src="'+hotRecipes.foodImgUrl+
                            '"/>'+
                            '<div><p>'+hotRecipes.foodName
                            +'</p><p>'+hotRecipes.foodIntroduce+
                            '</p></div></a></li>';
                        $("#hotStore").append(childli);
                    }
                    $(".foot_li").css("float","left");
                    $("li").css("list-style","none");
                });
            },
            error:function () {
                console.log("error_")
            }
        }
        );

        selfdata();

    });
    
    function selfdata() {
        console.log($.cookie("userId"));
        // console.log(userInfo);
        // console.log(getCookie("accountName"));
        if($.cookie("userId") ){
            $("#tolley_from").datagrid({
                url:'/self/tolleyData.action',
                rownumbers: true,
                border:false,
                pagination: true,
                showFooter: true,
                loadMsg:'数据加载中，请稍等...',
                columns:[
                    {field:'select',checkbox:true},
                    {field:'foodName',title:'食物名称',width:'40%',align:'right'},
                    {field:'foorPrice',title:'单价',width:'10%',align:'right'},
                    {field:'count',title:'数量',width:'30%',align:'right'}
                ],
                onBeforeLoad:function(param){
                    console.log(param);
                },
                onLoadSuccess: function (data){
                    console.log(data);
                },
                onLoadError: function (){
                    alert("数据加载失败！");
                }
            });
        }else{
            var trolleyInfo = '<div><a href="/htm/userlogin.action"><span>请登录</span></a></div>';
            $("#trolley_layout").append(trolleyInfo) ;
        }
    }
    
    
    function clickDetail(id) {
        window.location = "/view/detailData.action?id="+id;
    }

</script>
</html>
