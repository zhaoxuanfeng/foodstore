<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="header :: header">
</head>

<body style="margin:0px;">
<table id="dg" class="easyui-datagrid" title="用户管理 -- 用户登录信息" singleSelect="true" fitColumns="true" nowrap="false" striped="true"
       SelectOnCheck="true" CheckOnSelect="true" rownumbers="true" pagination="true" pageSize="25" pageList="[25, 50, 150]" toolbar="#tb" fit="true"
>
    <thead>
    <tr>
        <th field="select" align="center" checkbox="true">选择</th>
        <th field="userId" align="center" width="8%">用户ID</th>
        <th field="accountName" align="center" width="8%">账号</th>
        <th field="userName" align="center" width="10%">昵称</th>
        <th field="userRealname" align="center" width="10%">姓名</th>
        <th field="userPhone" align="center" width="8%">手机号</th>
        <th field="email" align="center" width="8%">邮箱</th>
        <th field="userSex" align="center" width="8%" >性别</th>
        <th field="userFlag" align="center" width="10%" >用户状态</th>
        <th field="userBirthday" align="center" width="9%" formatter="timeStamp2DateTime">生日</th>
        <th field="userAddress" align="center" width="8%">用户地址</th>
        <th field="createTime" align="center" width="9%" formatter="timeStamp2DateTime">创建时间</th>
        <th field="modifyTime" align="center" width="9%" formatter="timeStamp2DateTime">修改时间</th>
    </tr>
    </thead>
</table>
<div id="tb" style="padding:2px 5px;">
    <form id="formSearch">
        <input type="hidden" name="pageSize" id="pageSize" />
        <input type="hidden" name="pageNumber" id="pageNumber" />
        <!--查询条件: userId和手机号-->
        <div width="100%" style="margin:4px">
            用户ID：<input type="text"  name="id" class="easyui-textbox" maxlength="20" style="width:150px"/>&nbsp;&nbsp;
            手机号：<input type="text"  name="phone" class="easyui-textbox easyui-validatebox" data-options="validType:'length[11,11]'" maxlength="11" style="width:100px"/>&nbsp;&nbsp;
            账户：<input type="text" name="account" class="easyui-textbox" maxlength="20" style="width:150px"/>&nbsp;&nbsp;
            姓名：<input type="text"  name="realname" class="easyui-textbox" maxlength="20" style="width:150px"/>&nbsp;&nbsp;<br/><br/>
            注册时间：<input class="easyui-datebox" id="startDate" name="create_startTime" type="text" editable = "false"> --
            <input class="easyui-datebox" id="endDate" name="create_endTime" type="text" editable = "false">&nbsp;&nbsp;&nbsp;&nbsp;
            <a href="#" class="easyui-linkbutton" iconCls="icon-search" onclick="searchUser()">搜索</a>
        </div>
        <div width="100%" style="margin:4px">
            <a href="#" class="easyui-linkbutton" iconCls="icon-edit" onclick="">修改用户状态</a>&nbsp;&nbsp;
            <a href="#" class="easyui-linkbutton" iconCls="icon-edit" onclick="">刷新用户缓存</a>&nbsp;&nbsp;
            <a href="#" class="easyui-linkbutton" iconCls="icon-edit" onclick="">重置登录密码</a>&nbsp;&nbsp;
        </div>
    </form>
</div>
<div id="dlgModifyUserStatus" class="easyui-dialog" title="修改用户状态" width="400px" height="150px" closed="true" buttons="#dlgModifyUserStatus-buttons" style="padding:10px" modal="true">
    <form id="formModifyUserStatus" method="post">
        <input type="hidden" name="userId" id="userId" />
        <input type="hidden" name="userStatusOld" id="userStatusOld" />
        <table align="center" width="90%" cellpadding="2" cellspacing="2">
            <tr>
                <td>
                    将用户状态修改为：<select class="easyui-combobox" id="userStatusNew" name="userStatusNew" panelHeight="auto" editable="false" style="width:100px">
                    <option value="1">正常</option>
                    <option value="0">冻结</option>
                </select>
                </td>
            </tr>
        </table>
    </form>
</div>
<div id="dlgModifyUserStatus-buttons">
    <a href="javascript:void(0)" class="easyui-linkbutton" onclick="" iconcls="icon-save">保存</a>
    <a href="javascript:void(0)" class="easyui-linkbutton" onclick="" iconcls="icon-cancel">取消</a>
</div>

<!--点击刷新用户缓存后，显示的弹框-->
<div id="dlgRefreshUserCache" class="easyui-dialog" title="刷新用户缓存" width="400px" height="150px" closed="true" buttons="#dlgRefreshUserCache-buttons" style="padding:10px" modal="true">
    <form id="formRefreshUserCache" method="post">
        <table align="center" width="90%" cellpadding="2" cellspacing="2">
            <tr>
                <td>
                    需要刷新缓存的用户Id：<input type="text" id="refreshUserId" name="refreshUserId" class="easyui-textbox" maxlength="20" style="width:150px"/>&nbsp;&nbsp;
                </td>
            </tr>
        </table>
    </form>
</div>
<div id="dlgRefreshUserCache-buttons">
    <a href="javascript:void(0)" class="easyui-linkbutton" onclick="" iconcls="icon-save">刷新</a>
    <a href="javascript:void(0)" class="easyui-linkbutton" onclick="" iconcls="icon-cancel">取消</a>
</div>
</body>
<footer th:replace="footer :: footer"></footer>

<script type="text/javascript"  th:inline="none">

    $('#dg').datagrid({
        url:'/htm/userinfo_data.htm',
        striped: true,
        rownumbers:true,
        pagination: true,
        pageSize: 10,
        pageList: [10, 20, 50, 100, 150, 200],
        border : false,
        showFooter : true,
        loadMsg:'数据加载中，请稍等...',
        columns:[[
            {field:'select',checkbox:true},
            {field:'userId',title:'用户ID',width:'8%'},
            {field:'accountName',title:'帐号',width:'8%',align:'right'},
            {field:'userName',title:'用户名',width:'10%',align:'right'},
            {field:'userRealname',title:'姓名',width:'10%',align:'right'},
            {field:'userPhone',title:'手机号',width:'8%',align:'right'},
            {field:'email',title:'邮箱',width:'10%',align:'right'},
            {field:'userSex',title:'性别',width:'10%',align:'right'},
            {field:'userFlag',title:'用户状态',width:'10%',align:'right'},
            {field:'userBirthday',title:'出生日期',width:'10%',align:'right'},
            {field:'userAddress',title:'用户地址',width:'10%',align:'right'},
            {field:'createTime',title:'创建时间',width:'10%',align:'right'},
            {field:'modifyTime',title:'修改时间',width:'10%',align:'right'}
        ]],
        onBeforeLoad:function(param){
            console.log(param);
        },
        onLoadSuccess: function (data){
            console.log(data);
        },
        onLoadError: function (){
            alert("数据加载失败！");
        }
    });

    function searchUser() {
        $("#dg").datagrid("loading");
        $.get("/htm/userinfo_data.htm",$("#formSearch").serialize(),function (pager) {
            $("#dg").datagrid("loadData",{total:pager.total,rows:pager.rows,pageNumber:pager.pageNumber,pageSize:pager.pageSize});
            $("#dg").datagrid("loaded");
        });


    }




</script>